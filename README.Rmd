---
title: "Can we "
author: "Your names in alphabetical order with Dan"
date: "5/29/2020"
output: 
  tufte::tufte_html: default
  
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
pressy <- readr::read_csv("pressy.csv")
farewell <- readr::read_csv("farewell.csv")
#load some libraries
#load some libraries
library(tidytext)
library(textfeatures)
library(dplyr)
library(ggplot2)
library(stargazer)

#adds paragraph numbers and speech names
reference<-1:66

#this dataframe has the paragraph numbers
farewell_2<-data.frame(farewell, reference)

#breaks apart the pargraphs by word and then counts them by pargraph 
farewell_words<-farewell_2%>%
  unnest_tokens(word, paragraph)%>%
  count(reference, word, sort = TRUE)

#all words are counted by paragraph, ref is paragraph number, n is count
total_words <- farewell_words %>% 
  group_by(reference) %>% 
  summarize(total = sum(n))

#join these back to paragraph words, this is key for some measures
paragraph_words <- left_join(farewell_words, total_words, by="reference")

#get a frequency by rank
freq_by_rank <- paragraph_words %>% 
  group_by(reference) %>% 
  mutate(rank = row_number(), 
         `term frequency` = n/total)

#frequency by rank 2 which is by the whole document
freq_by_rank2 <- paragraph_words %>% 
  group_by(word)%>%
  summarize(totes=sum(n))%>%
  arrange(desc(totes))%>%
  mutate("rank"=row_number(), "term frequency"= totes/sum(totes))

freq_by_rank %>% 
  ggplot(aes(rank, `term frequency`, color = reference)) + 
  geom_line(size = 1.1, alpha = 0.8, show.legend = FALSE) + 
  scale_x_log10() +
  scale_y_log10()


freq_by_rank2 %>% 
  ggplot(aes(rank, `term frequency`)) + 
  geom_line(size = 1.1, alpha = 0.8, show.legend = FALSE) + 
  scale_x_log10() +
  scale_y_log10()


Zprime<-paragraph_words%>%
  bind_tf_idf(word, reference,n)


A<-get_sentiments("afinn")
B<-get_sentiments("nrc")
C<-get_sentiments("bing")
D<-get_sentiments("loughran")


Afinn<-inner_join(farewell_words, A)

pressy%>%
  group_by(word)%>%
  summarize(mean(score))


prezz<-inner_join(farewell_words, pressy)

prezz_final<-prezz%>%
  group_by(reference)%>%
  summarize(sum(score), sd(score), mean(score))

Afinn_final<-Afinn%>%
  group_by(reference)%>%
  summarize(sum(value), sd(value), mean(value))

#code that makes the joins work
colnames(Afinn_final)[3]<-"sd(score)"
colnames(Afinn_final)[4]<-"mean(score)"
Afinn_final<-mutate(Afinn_final, type="Afinn")
prezz_final<-mutate(prezz_final, type="Pressy")


comp<-bind_rows(Afinn_final, prezz_final)
ggplot(comp, aes(reference, 'mean(score)', color=type))+geom_jitter()

#this makes the result sheet
hulk<-left_join(Afinn_final, prezz_final, by="reference")
comparative<-data.frame(balance=hulk$`mean(score).x`-hulk$`mean(score).y`, var=hulk$`sd(score).x`-hulk$`mean(score).y`)


```

# How do sentiment models work?

Lexicons thats how, here are 5 randomly sampled words from four popular lexicons and then ours. Here is where we can add a whole bunch of text. I will :brain: use a bunch of the options to really help you see how well this works. ^[[Obama's Farewell](https://www.presidency.ucsb.edu/documents/farewell-address-the-nation-from-chicago-illinois)]

* amazing
  + boop

## Wow

### Smaller

*List
  +item 1
  +item 2
  
Column 1 | Column 2 | Column 3
---------| -------- | --------
Obama    | President| Dude
Bush     | President| Bro
Biden    | Vice President | Guy

##A variety of things

```{r stuff and junk}
knitr::kable(
  pressy[1:4, 1:4], caption = 'A subset of our system.'
)

```


```{r Sentiments, fig.margin=TRUE}

A1<-sample_n(A, 5)%>%
  mutate("type"="Afinn")

A1

B1<-sample_n(B, 5)%>%
  mutate("type"="NRC")
B1
C1<-sample_n(C, 5)%>%
  mutate("type"="Bing")
C1
D1<-sample_n(D, 5)%>%
  mutate("type"="Loughran")
D1

E1<-sample_n(pressy, 5)%>%
  mutate("type"="pressy")
E1


```

```{r i said crap a lot in an ecampus lecture}
knitr::kable(
  A1[1:3, 1:3], caption = 'A subset of our system.'
)

knitr::kable(
  B1[1:5, 1:2], caption = 'A subset of our system.'
)

```

## Including Plots

Here is the big plot that loos super messy.

```{r pressure, echo=FALSE, fig.margin=TRUE}
ggplot(comp, aes(reference, 'mean(score)', color=type))+geom_jitter()

ggplot(comp, aes(reference, 'mean(score)', color=type))+geom_line()

knitr::include_graphics(
  'https://i.kym-cdn.com/photos/images/newsfeed/000/598/653/75f.jpg',
  auto_pdf = getOption("knitr.graphics.auto_pdf", FALSE),
  dpi = NULL,
  error = TRUE
)

```

And it is clear that this is a graphic that says some stuff. 

```{r description of what is up}

ggplot(comparative, aes(1:dim(comparative)[1], balance, colour=var))+geom_jitter()

```

```{marginfigure, echo = TRUE}
Here is a random side note. As you may know, I love this stuff. 

```

Values of under zero indicate that our analysis was substantially more positive than Afinn
